# 1. Exploring Website Information and Generating Wordlist:

- During the process of exploring a website, we discovered the presence of user information.

![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/6dd20bda-c7bb-4c52-bdb9-afcebefcb6de)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/611b278c-e6bc-450c-a215-3d4d0774a99f)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/370b18a8-196d-4dff-bf14-918d73381b0c)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/7471ec01-b4bc-409a-9f55-594eb1aebf85)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/e10c3dca-450b-491d-9759-17c92437a02a)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/95028718-f80b-4a76-bcad-daa7e5ac7b4e)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/107b3a47-72b8-493b-9f2e-e4bd34bbd905)
![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/2a7bf9db-8124-46fe-b646-2c2c4dce0ec1)


- We compiled a list of usernames and saved them in a file for further analysis and use.

![image](https://github.com/singhx-hub/Active-Directory--Home-Lab-/assets/126919241/7dbdf2ff-7c89-4725-b6c6-f15ab3f136ee)

-  Use the ["usernamify"](https://github.com/singhx-hub/Usernamify) script to generate usernames by combining the first and last names from our user list and save the output in a text file

```python
└─$ ./usernamify.py web-users > userlist
jonathontaylor
taylorjonathon
jonathon.taylor
taylor.jonathon
taylorj
----snip------
tjonathon
j.taylor
t.jonathon
jonathon
```

> ## Machines required: WorkStation-01, UbuntuMail, and Kali machine.

- Navigate to the mail server in the browser using the UbuntuMail IP.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/a7cb57e2-f47a-4bb8-aeea-c7d076270f1f)

- Open Burp Suite and intercept the request using a proxy

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/0e1243e8-e064-46b4-98fa-fcdd27d2f066)

- In Burp Suite's Intruder tool, initiate the attack by selecting the request and specifying the user and pass arguments for fuzzing. Add the generated username list to the user section and include common passwords like "summer2021!" and "fall2020!" as payload options. Configure the attack method as "Cluster Bomb" and launch the attack to test different combinations.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/1a001328-1ea6-444e-8b47-2585fe94e301)

- Accomplished the task by successfully identifying the username "a.tarolli" along with the corresponding password "Summer2021!"
- Log in to the mail server using the a.tarolli creds.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/fb42b533-d0d2-4fe6-81b7-b045e2975eb8)

## Phishing Email

- Setup listener on Covenant and generate a PowerShell launcher. 
- Host a file named rev.ps1 and copy the highlighted encoded luncher.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/b212bcc4-2595-4d6d-a3d7-c6bfc932e995)

As we don't have MS Word installed on our system so we will use [Nishang's Out-File.ps1 script](https://github.com/samratashok/nishang/blob/master/Client/Out-Word.ps1) to create a Word document and autorun macro with provided payload.


![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/1e69618b-0d57-4d91-8e98-c510b63c1d36)

> Setup smbserver using cmd `smbserver.py Share . -smb2support`. To make the file build successfully.

Host the file through Covenant Listener to transfer it.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/03c10d80-b013-4c9d-8a8f-97397aa73bb9)

Now, we will send the email with the phishing file linked on the link. Click send.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/df34a823-442c-4922-afe1-0dae15e1c300)

When on the Workstation-01 we will download the file and open it with enable editing. There is nothing happening on the Workstation-01, but on our Kali machine Covenant, we have an active Grunt activated which means now we shell.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/499854eb-afb3-47e7-838c-f1416fb8a75b)

> ## Alternate

If in case we don't have MS Word installed in our system we can utilize the `.hta` file to get a shell on Covenant. For this, we need the code:

```vb
<script language="VBScript">

  Function DoStuff()

               Dim wsh

               Set wsh = CreateObject("Wscript.Shell")

                wsh.run "<powershell command>"

               Set wsh = Nothing

  End Function

  DoStuff

  self.close

</script>
```

Now, follow the same steps as above, edit the link in the phishing email and setup listener with the host `.hta` file

When the user opens the file, we will find the grunts active.

![image](https://github.com/thesinghsec/Active-Directory--Home-Lab-/assets/126919241/c718cb1f-9b3a-4cf5-a0b5-420f07fc95d3)

